# 产品需求文档 (PRD): macOS 轻量级 OCR 工具

| 项目名称 | macOS OCR Helper (暂定) |
| :--- | :--- |
| **版本** | v1.0.0 |
| **状态** | 草案 (Draft) |
| **负责人** | 开发者 |
| **日期** | 2026-01-16 |

---

## 1. 产品概述

### 1.1 背景
在日常办公中，经常会遇到无法复制文本的场景（如图片、受保护的网页、PDF 扫描件等）。虽然 macOS 自带 Live Text 功能，但在响应速度、流程自动化（如自动存入剪贴板）以及多语言切换方面仍有优化空间。

### 1.2 目标
开发一款极简、响应极快且隐私安全的 macOS 原生小工具，通过“快捷键 -> 框选 -> 得到结果”的极短路径，解决文字提取需求。

### 1.3 核心价值
- **效率：** 减少操作步骤，识别后自动处理结果。
- **隐私：** 优先采用本地 OCR 引擎，不上传敏感数据。
- **轻量：** 极低的资源占用，无干扰的 UI 设计。

---

## 2. 用户流程 (User Flow)

1. **唤起：** 用户按下全局自定义快捷键（默认 `Cmd + Option + A`）。
2. **框选：** 屏幕进入截屏状态，用户拖拽鼠标选择需要识别的区域。
3. **识别：** 松开鼠标，系统调用 OCR 引擎进行像素解析。
4. **输出：** - 识别结果自动复制到系统剪贴板。
   - 屏幕右侧/鼠标处显示极简通知或浮窗，展示识别内容。

---

## 3. 功能需求

### 3.1 核心功能 (P0)
- **全局快捷键：** 支持后台监听，可在设置中自定义。
- **屏幕截图交互：** - 屏幕遮罩：唤起后屏幕变暗。
    - 放大镜：在框选时提供像素级微调参考。
    - 取消操作：按 `Esc` 退出。
- **OCR 识别引擎：** 集成 Apple Vision Framework，支持离线识别。
- **剪贴板集成：** 识别结果即时写入剪贴板。

### 3.2 基础 UI (P1)
- **状态栏菜单 (Menu Bar)：**
    - 快速启动/设置/退出。
    - 显示最近一次 OCR 识别状态。
- **结果预览窗：** 识别后弹出轻量浮窗，支持简单的编辑或重新复制。

### 3.3 进阶功能 (P2)
- **多语言优化：** 自动检测语种（中、英、日、韩、德、法等）。
- **段落合并：** 智能去除识别结果中不必要的换行符，保持语义连贯。
- **二维码识别：** 若框选内容为二维码，自动解析并打开链接。

---

## 4. 技术方案建议

### 4.1 核心技术栈
- **开发语言：** Swift 5.x
- **UI 框架：** SwiftUI (用于设置界面和浮窗) + AppKit (用于截图遮罩层)
- **OCR 引擎：** `VNRecognizeTextRequest` (Apple Vision Framework)
- **权限管理：** 需要在 `Info.plist` 中声明并引导用户开启 **屏幕录制 (Screen Recording)** 权限。

### 4.2 OCR 逻辑说明
1. 捕获框选区域的 `CGImage`。
2. 创建 `VNImageRequestHandler` 对象。
3. 配置 `recognitionLevel` 为 `.accurate` 以保证精度。
4. 处理识别后的 `VNRecognizedTextObservation` 数组，按坐标顺序拼接文本。

---

## 5. UI/UX 规范
- **设计风格：** 遵循 macOS Ventura/Sonoma 原生风格（毛玻璃、圆角）。
- **交互反馈：** - 成功识别：播放轻微系统音效（可选）或展示微型 Checkmark。
    - 识别失败：浮窗提示“未检测到文字”。

---

## 6. 非功能需求
- **性能：** 唤起延迟 < 100ms，识别耗时（针对普通长度文本） < 500ms。
- **包体积：** 尽量控制在 10MB 以内（不依赖笨重的第三方库）。
- **兼容性：** 兼容 macOS 12.0 (Monterey) 及以上版本。

---

## 7. 路线图 (Roadmap)
- **Phase 1:** 完成截图与 Vision 框架对接，实现“剪贴板自动写入”。
- **Phase 2:** 开发状态栏菜单与自定义快捷键功能。
- **Phase 3:** 增加历史记录查看与 LLM (如 GPT-4/Claude) 翻译接口集成。